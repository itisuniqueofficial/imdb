<script>document.addEventListener("DOMContentLoaded", function () {
    // Create the HTML structure
    const container = document.createElement("div");
    container.innerHTML = `
        <div class="player-wrapper" id="playerWrapper" aria-label="Movie Player"></div>
        <div class="error-container" id="errorContainer" role="alert">
            <div class="error-message"></div>
        </div>
        <div aria-hidden="true" class="preloader" id="preloader">
            <div class="dots-container">
                <div class="dot red"></div>
                <div class="dot green"></div>
                <div class="dot yellow"></div>
            </div>
            <noscript><style>.preloader { display: none; }</style></noscript>
        </div>
    `;
    document.body.appendChild(container);

    // Load CSS with preload optimization
    ["styles1.css", "styles2.css", "styles3.css"].forEach(file => {
        let link = document.createElement("link");
        link.rel = "preload";
        link.as = "style";
        link.href = file;
        link.onload = () => link.rel = "stylesheet";
        document.head.appendChild(link);
    });

    // Load Scripts dynamically (optimized async vs. defer)
    const scriptPromises = [
        { file: "script1.js", async: false },
        { file: "script2.js", async: true },
        { file: "script3.js", async: false },
        { file: "script4.js", async: true },
        { file: "script5.js", async: false }
    ].map(({ file, async }) => {
        return new Promise((resolve, reject) => {
            let script = document.createElement("script");
            script.src = file;
            script.async = async;
            script.defer = !async;
            script.onload = resolve;
            script.onerror = () => reject(`Failed to load: ${file}`);
            document.body.appendChild(script);
        });
    });

    // Handle script loading completion
    Promise.all(scriptPromises)
        .then(() => console.log("All scripts loaded successfully!"))
        .catch(error => console.error("Error loading scripts:", error));

    // Lazy Load Images
    let observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                let img = entry.target;
                img.src = img.dataset.src;
                observer.unobserve(img);
            }
        });
    });

    document.querySelectorAll("img.lazy-load").forEach(img => observer.observe(img));
});</script>
